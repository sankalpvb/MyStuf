<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel</title>
</head>
<body>
  <h1>üìù Add a New Poem</h1>
  <input type="text" id="title" placeholder="Poem Title"><br><br>
  <textarea id="content" placeholder="Poem Content"></textarea><br><br>
  <button onclick="addPoem()">Add Poem</button>

  <script>
    const token = "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"; 
    const repoOwner = "sankalpvb";
    const repoName = "MyStuf";
    const filePath = "poems.json";

    async function addPoem() {
      const title = document.getElementById("title").value.trim();
      const content = document.getElementById("content").value.trim();
      if (!title || !content) return alert("Please fill all fields!");

      // Get existing poems
      const res = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`);
      const fileData = await res.json();
      const poems = JSON.parse(atob(fileData.content));

      // Add new poem
      poems.push({ title, content });

      // Update file
      const updatedContent = btoa(JSON.stringify(poems, null, 2));
      await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`, {
        method: "PUT",
        headers: {
          "Authorization": `token ${token}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          message: "Add new poem",
          content: updatedContent,
          sha: fileData.sha
        })
      });

      alert("Poem added successfully!");
    }
  </script>
</body>
</html>
